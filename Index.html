<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Momentum</title>
</head>

<body>

  <!-- HEADER -->
  <header class="topbar">
    <div class="top-left">
      <div class="logo">M</div>
      <div class="app-info">
        <div class="app-title">Momentum</div>
        <div class="app-sub">Reports • Timers • Notes</div>
      </div>
    </div>

    <div class="top-right">
      <button id="exportBtn" class="top-btn">Export</button>
      <button id="importBtn" class="top-btn">Import</button>
      <input id="importInput" type="file" accept="application/json" style="display:none;">
    </div>
  </header>


  <!-- HOME PAGE -->
  <main id="page-home" class="page">

    <section class="card summary-card">
      <div class="summary-row">
        <div>
          <div class="small-label">Today’s total</div>
          <div id="todayTotal" class="big-time">0m</div>
        </div>
        <div class="streak-box">
          <div class="small-label">Streak</div>
          <div id="streakCount" class="big-time">0d</div>
        </div>
      </div>

      <div class="categories-row">
        <div class="category-badge">
          <div class="cat-label">Study</div>
          <div id="studyTotal" class="cat-time">0m</div>
        </div>
        <div class="category-badge">
          <div class="cat-label">Project</div>
          <div id="projectTotal" class="cat-time">0m</div>
        </div>
        <div class="category-badge">
          <div class="cat-label">Workout</div>
          <div id="workoutTotal" class="cat-time">0m</div>
        </div>
        <div class="category-badge">
          <div class="cat-label">Social</div>
          <div id="socialTotal" class="cat-time">0m</div>
        </div>
      </div>
    </section>

    <!-- DONUT CHART -->
    <section class="card chart-block">
      <div class="chart-header">
        <span class="chart-title">Daily Distribution</span>
        <span class="chart-action">Breakdown</span>
      </div>

      <div class="donut-wrapper">
        <canvas id="donutChart"></canvas>
        <div id="donutCenter" class="donut-center">0h</div>
      </div>

      <div id="donutLegend" class="donut-legend"></div>
    </section>

    <!-- LINE CHART -->
    <section class="card chart-block">
      <div class="chart-header">
        <span class="chart-title">Weekly Trend</span>
        <span class="chart-date" id="trendDateRange"></span>
      </div>

      <canvas id="lineChart"></canvas>
    </section>

    <!-- RECENT SESSIONS -->
    <section class="card recent-card">
      <div class="recent-title">Recent sessions</div>
      <div id="recentSessions" class="recent-list"></div>
    </section>

    <div class="footer-info">Offline • Single file • LocalStorage</div>

  </main>


  <!-- TIMERS PAGE -->
  <main id="page-timers" class="page" style="display:none;">

    <section class="card timers-card">
      <div class="timers-header">
        <div class="timers-title">Daily Timers</div>
        <button id="addCategoryBtn" class="add-btn">+ Add</button>
      </div>

      <div id="timersList"></div>

      <button id="clearTodayBtn" class="clear-btn">Clear Today</button>
    </section>

    <div class="footer-info">Offline • Single file • LocalStorage</div>

  </main>


  <!-- NOTES PAGE -->
  <main id="page-notes" class="page" style="display:none; padding-bottom:80px;">

    <section class="card notes-card">
      <div class="notes-date" id="notesTodayHeader"></div>
      <textarea id="notesInput" class="notes-input" placeholder="What did you achieve today?"></textarea>
      <button id="saveNotesBtn" class="save-btn">Save</button>
    </section>

    <section class="card notes-history-card">
      <div class="history-title">Previous Notes</div>
      <div id="notesHistory"></div>
    </section>

    <div class="footer-info">Offline • Single file • LocalStorage</div>
<style>

:root{
  --bg:#f5f7fb;
  --card:#ffffff;
  --radius:18px;
  --shadow:0 4px 18px rgba(0,0,0,0.06);
  --blue:#0b69ff;
  --text:#111;
  --text-light:#667085;
  --border:#e5e7eb;
  --nav-inactive:#9ca3af;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;}
html,body{background:var(--bg);height:100%;}

/* TOP BAR */
.topbar{
  position:sticky;top:0;z-index:50;
  background:var(--bg);
  padding:14px 16px;
  display:flex;justify-content:space-between;align-items:center;
  border-bottom:1px solid var(--border);
}
.top-left{display:flex;align-items:center;gap:10px;}
.logo{
  background:var(--blue);color:#fff;
  width:36px;height:36px;border-radius:12px;
  display:flex;justify-content:center;align-items:center;
  font-weight:700;font-size:18px;
}
.app-title{font-weight:700;font-size:18px;color:var(--text);}
.app-sub{font-size:12px;color:var(--text-light);}
.top-btn{
  padding:6px 14px;border:none;
  background:var(--card);
  border-radius:12px;
  box-shadow:var(--shadow);
  font-size:14px;
}
.top-right{display:flex;gap:10px;}

/* PAGE LAYOUT */
.page{padding:16px;padding-bottom:90px;}

/* CARDS */
.card{
  background:var(--card);
  border-radius:var(--radius);
  padding:16px;
  margin-bottom:20px;
  box-shadow:var(--shadow);
}

/* SUMMARY */
.summary-row{display:flex;justify-content:space-between;}
.small-label{font-size:13px;color:var(--text-light);}
.big-time{font-weight:700;font-size:26px;color:var(--text);}
.categories-row{
  margin-top:12px;
  display:flex;flex-wrap:wrap;gap:10px;
}
.category-badge{
  background:#fff;border:1px solid var(--border);
  border-radius:var(--radius);
  padding:10px 14px;
  text-align:center;
}
.cat-label{font-size:13px;color:var(--text-light);}
.cat-time{font-size:15px;font-weight:600;color:var(--text);}

/* CHARTS */
.chart-block{}
.chart-header{
  display:flex;justify-content:space-between;
  margin-bottom:8px;
}
.chart-title{font-weight:600;color:var(--text);}
.chart-action{font-size:13px;color:var(--text-light);}
.chart-date{font-size:13px;color:var(--text-light);}
.donut-wrapper{
  position:relative;
  width:100%;
  max-width:260px;
  margin:auto;
}
#donutChart{width:100%!important;height:auto!important;}
.donut-center{
  position:absolute;
  top:50%;left:50%;
  transform:translate(-50%,-50%);
  font-size:22px;font-weight:700;
}
.donut-legend{
  margin-top:12px;
  display:flex;flex-direction:column;
  gap:8px;
  font-size:14px;
}

/* LINE CHART */
#lineChart{width:100%!important;height:auto!important;}

/* RECENT */
.recent-title{font-weight:600;margin-bottom:10px;}
.recent-list{font-size:14px;color:var(--text-light);}

/* TIMERS */
.timers-header{
  display:flex;justify-content:space-between;align-items:center;
  margin-bottom:10px;
}
.timers-title{font-weight:700;font-size:18px;}
.add-btn{
  background:var(--blue);color:#fff;border:none;
  padding:8px 14px;border-radius:12px;
}
.clear-btn{
  margin-top:12px;padding:10px;
  border:none;background:#eee;border-radius:12px;
}
.timer-item{
  background:#fff;border:1px solid var(--border);
  border-radius:var(--radius);padding:14px;margin-bottom:12px;
}
.timer-title{font-weight:600;}
.timer-goal{font-size:13px;color:var(--text-light);margin-bottom:10px;}
.timer-row{display:flex;gap:6px;}
.timer-btn{
  flex:1;padding:10px;border:none;border-radius:10px;
  background:#f3f4f6;
}
.timer-btn.start{background:var(--blue);color:#fff;}

/* NOTES */
.notes-date{font-weight:700;margin-bottom:10px;font-size:18px;}
.notes-input{
  width:100%;height:110px;
  padding:12px;border-radius:14px;
  background:#f3f4f6;border:none;resize:none;
  font-size:15px;
}
.save-btn{
  margin-top:12px;width:100%;
  padding:12px;border:none;
  background:var(--blue);color:#fff;
  border-radius:14px;font-size:16px;
}
.history-title{font-weight:700;margin-bottom:10px;}
.history-entry{
  background:#fff;border:1px solid var(--border);
  padding:10px;border-radius:14px;
  margin-bottom:10px;
}
.history-date{font-weight:600;margin-bottom:4px;}
.history-text{font-size:14px;color:var(--text-light);}

/* FOOTER INFO */
.footer-info{
  text-align:center;font-size:13px;color:var(--text-light);
  margin-top:10px;margin-bottom:50px;
}

/* NAV BAR */
.bottom-nav{
  position:fixed;bottom:0;left:0;width:100%;
  background:#fff;border-top:1px solid var(--border);
  height:70px;display:flex;justify-content:space-around;align-items:center;
}
.nav-btn{
  background:none;border:none;
  display:flex;flex-direction:column;
  align-items:center;gap:4px;
  color:var(--nav-inactive);
}
.nav-btn.nav-active{color:var(--blue);}
.nav-icon-wrap{width:24px;height:24px;}
.nav-icon{
  width:100%;height:100%;
  stroke:currentColor;
}
.nav-btn span{
  font-size:12px;
}

  </style>
    
  </main>


  <!-- BOTTOM NAV -->
  <nav class="bottom-nav">
    <button class="nav-btn nav-active" data-page="page-home">
      <div class="nav-icon-wrap">
        <svg viewBox="0 0 24 24" class="nav-icon">
          <path d="M12 3L3 10h3v8h12v-8h3z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <span>Home</span>
    </button>

    <button class="nav-btn" data-page="page-timers">
      <div class="nav-icon-wrap">
        <svg viewBox="0 0 24 24" class="nav-icon">
          <circle cx="12" cy="12" r="8" stroke-width="2"/>
          <path d="M12 8v4l3 2" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <span>Timers</span>
    </button>

    <button class="nav-btn" data-page="page-notes">
      <div class="nav-icon-wrap">
        <svg viewBox="0 0 24 24" class="nav-icon">
          <path d="M4 4h16v14H4z" stroke-width="2"/>
          <path d="M8 8h8M8 12h5" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <span>Notes</span>
    </button>
  </nav>

</body>
</html>
<script>

// -------------------------
// GLOBAL STORAGE
// -------------------------
let data = JSON.parse(localStorage.getItem("momentum-data") || "{}");
if(!data.timers) data.timers = {
  study:{goal:360, sessions:[]},
  project:{goal:240, sessions:[]},
  workout:{goal:60, sessions:[]},
  social:{goal:30, sessions:[]}
};
if(!data.notes) data.notes = {};
save();

function save(){
  localStorage.setItem("momentum-data", JSON.stringify(data));
}

// -------------------------
// NAVIGATION
// -------------------------
const pages = document.querySelectorAll(".page");
const navBtns = document.querySelectorAll(".nav-btn");

navBtns.forEach(btn=>{
  btn.addEventListener("click", ()=>{
    const page = btn.dataset.page;

    navBtns.forEach(b=>b.classList.remove("nav-active"));
    btn.classList.add("nav-active");

    pages.forEach(p=>p.style.display="none");
    document.getElementById(page).style.display="block";

    if(page==="page-home") renderHome();
    if(page==="page-timers") renderTimers();
    if(page==="page-notes") renderNotes();
  });
});

// -------------------------
// TIME HELPERS
// -------------------------
function nowMinutes(){
  return Math.floor(Date.now()/60000);
}
function minutesToHM(m){
  if(m<=0) return "0m";
  let h = Math.floor(m/60);
  let mm = m%60;
  if(h>0) return `${h}h ${mm}m`;
  return `${mm}m`;
}

// -------------------------
// HOME PAGE RENDER
// -------------------------
let donutChart=null;
let lineChart=null;

function renderHome(){
  // compute today's totals
  let today = new Date().toISOString().slice(0,10);
  let totals = {study:0,project:0,workout:0,social:0};
  let sessions = [];

  for(let key in data.timers){
    let t = data.timers[key];
    t.sessions.forEach(s=>{
      if(s.date===today){
        totals[key]+=s.mins;
        sessions.push({...s, category:key});
      }
    });
  }

  // update top badges
  document.getElementById("todayTotal").innerText =
    minutesToHM(Object.values(totals).reduce((a,b)=>a+b,0));
  document.getElementById("studyTotal").innerText = minutesToHM(totals.study);
  document.getElementById("projectTotal").innerText = minutesToHM(totals.project);
  document.getElementById("workoutTotal").innerText = minutesToHM(totals.workout);
  document.getElementById("socialTotal").innerText = minutesToHM(totals.social);

  // streak (simplified)
  document.getElementById("streakCount").innerText = data.streak || "0d";

  // render donut
  renderDonut(totals);

  // render weekly
  renderWeeklyLine();

  // recent sessions
  let rs = document.getElementById("recentSessions");
  rs.innerHTML = "";
  sessions.slice(-8).reverse().forEach(s=>{
    let div = document.createElement("div");
    div.className="recent-item";
    div.innerText = `${s.category} - ${minutesToHM(s.mins)}`;
    rs.appendChild(div);
  });
}

// -------------------------
// DONUT CHART
// -------------------------
function renderDonut(totals){
  const ctx = document.getElementById("donutChart");

  const values = Object.values(totals);
  const sum = values.reduce((a,b)=>a+b,0);

  document.getElementById("donutCenter").innerText = (sum/60).toFixed(1)+"h";

  const colors = ["#0ea5e9","#22c55e","#f97316","#ef4444"];

  if(donutChart) donutChart.destroy();
  donutChart = new Chart(ctx,{
    type:"doughnut",
    data:{
      labels:["Study","Project","Workout","Social"],
      datasets:[{
        data:values,
        backgroundColor:colors,
        borderWidth:0,
        hoverOffset:4,
        cutout:"60%"
      }]
    },
    options:{
      responsive:true,
      plugins:{legend:{display:false}}
    }
  });

  // legend
  let dl = document.getElementById("donutLegend");
  dl.innerHTML = "";
  ["Study","Project","Workout","Social"].forEach((c,i)=>{
    let m = values[i];
    let perc = sum? ((m/sum)*100).toFixed(0) : 0;
    let row = document.createElement("div");
    row.innerHTML = `
      <span style="display:inline-block;width:12px;height:12px;background:${colors[i]};border-radius:4px;margin-right:6px;"></span>
      ${c} — ${minutesToHM(m)}, ${perc}%`;
    dl.appendChild(row);
  });
}

// -------------------------
// WEEKLY LINE CHART
// -------------------------
function renderWeeklyLine(){
  const ctx = document.getElementById("lineChart");

  let labels = [];
  let totals = [];
  for(let i=6;i>=0;i--){
    let d = new Date(Date.now() - i*86400000);
    let ds = d.toISOString().slice(0,10);
    labels.push(ds.slice(5));

    let sum=0;
    for(let key in data.timers){
      data.timers[key].sessions.forEach(s=>{
        if(s.date===ds) sum+=s.mins;
      });
    }
    totals.push((sum/60).toFixed(1)); // hours
  }

  document.getElementById("trendDateRange").innerText =
    `${labels[0]} → ${labels[6]}`;

  if(lineChart) lineChart.destroy();
  lineChart = new Chart(ctx,{
    type:"line",
    data:{
      labels:labels,
      datasets:[{
        label:"Hours",
        data:totals,
        borderColor:"#0b69ff",
        backgroundColor:"rgba(11,105,255,0.2)",
        tension:0.3,
        fill:true,
        pointRadius:4
      }]
    },
    options:{
      responsive:true,
      scales:{
        y:{beginAtZero:true}
      },
      plugins:{legend:{display:false}}
    }
  });
}

// -------------------------
// TIMERS PAGE
// -------------------------
let running = {}; // {study:{start:1234}, ...}

function renderTimers(){
  let wrap = document.getElementById("timersList");
  wrap.innerHTML = "";

  for(let key in data.timers){
    let t = data.timers[key];
    let div = document.createElement("div");
    div.className="timer-item";
    div.innerHTML = `
      <div class="timer-title">${key[0].toUpperCase()+key.slice(1)}</div>
      <div class="timer-goal">Goal: ${minutesToHM(t.goal)}</div>

      <div class="timer-row">
        <button class="timer-btn start" data-act="start" data-cat="${key}">Start</button>
        <button class="timer-btn" data-act="stop" data-cat="${key}">Stop</button>
        <button class="timer-btn" data-act="log" data-cat="${key}">Log</button>
        <button class="timer-btn" data-act="del" data-cat="${key}">Del</button>
      </div>
    `;
    wrap.appendChild(div);
  }

  wrap.querySelectorAll(".timer-btn").forEach(btn=>{
    btn.onclick = ()=>{
      let cat = btn.dataset.cat;
      let act = btn.dataset.act;

      if(act==="start"){
        running[cat]={start:nowMinutes()};
      }
      if(act==="stop"){
        if(running[cat]){
          let mins = nowMinutes()-running[cat].start;
          addSession(cat, mins);
          delete running[cat];
        }
      }
      if(act==="log"){
        let m = parseInt(prompt("Minutes to add?")||"0");
        if(m>0) addSession(cat,m);
      }
      if(act==="del"){
        if(confirm("Delete all sessions?")){
          data.timers[cat].sessions=[];
          save();
        }
      }

      renderTimers();
    };
  });

  document.getElementById("clearTodayBtn").onclick = ()=>{
    let today = new Date().toISOString().slice(0,10);
    for(let k in data.timers){
      data.timers[k].sessions = data.timers[k].sessions.filter(s=>s.date!==today);
    }
    save();
    renderTimers();
  };
}

function addSession(cat, mins){
  if(mins<=0) return;
  let today = new Date().toISOString().slice(0,10);
  data.timers[cat].sessions.push({
    date:today,
    mins:mins
  });
  save();
}

// -------------------------
// NOTES PAGE
// -------------------------
function renderNotes(){
  let today = new Date().toISOString().slice(0,10);
  document.getElementById("notesTodayHeader").innerText = today;
  document.getElementById("notesInput").value = data.notes[today] || "";

  let hist = document.getElementById("notesHistory");
  hist.innerHTML = "";
  Object.keys(data.notes).sort().reverse().forEach(d=>{
    if(d===today) return;
    let div = document.createElement("div");
    div.className="history-entry";
    div.innerHTML=`
      <div class="history-date">${d}</div>
      <div class="history-text">${data.notes[d]}</div>
    `;
    hist.appendChild(div);
  });

  document.getElementById("saveNotesBtn").onclick = ()=>{
    let txt = document.getElementById("notesInput").value.trim();
    if(txt.length>0){
      data.notes[today]=txt;
    } else delete data.notes[today];
    save();
    renderNotes();
  };
}

// -------------------------
// EXPORT / IMPORT
// -------------------------
document.getElementById("exportBtn").onclick = ()=>{
  let blob = new Blob([JSON.stringify(data)], {type:"application/json"});
  let a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "momentum.json";
  a.click();
};

document.getElementById("importBtn").onclick = ()=>{
  document.getElementById("importInput").click();
};

document.getElementById("importInput").onchange = e=>{
  let file = e.target.files[0];
  if(!file) return;
  let reader = new FileReader();
  reader.onload = ()=>{
    try{
      data = JSON.parse(reader.result);
      save();
      renderHome();
    }catch(err){ alert("Invalid file"); }
  };
  reader.readAsText(file);
};

// -------------------------
// INIT
// -------------------------
renderHome();

                </script>
