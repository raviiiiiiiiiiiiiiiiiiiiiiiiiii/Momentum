<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Momentum — Silver Frost</title>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  :root{
    --bg-1: #f6f7f9;
    --bg-2: #eef0f3;
    --base-dark: #031019;
    --glass: rgba(255,255,255,0.07);
    --glass-2: rgba(255,255,255,0.045);
    --glass-3: rgba(255,255,255,0.03);
    --muted: rgba(255,255,255,0.72);
    --accent-a: linear-gradient(90deg,#ffffffcc,#ffffff77);
    --accent-b: linear-gradient(90deg,#f3f5f8,#e8ecf0);
    --pill-border: rgba(255,255,255,0.12);
    --glass-border: rgba(255,255,255,0.10);
    --radius: 20px;
    --shadow-1: 0 10px 30px rgba(0,8,18,0.55);
    font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  }

  /* Page base */
  html,body{height:100%;margin:0;background:
    radial-gradient(1200px 400px at 10% 10%, rgba(255,255,255,0.02), transparent 10%),
    linear-gradient(180deg, #06121e 0%, #071022 100%);
    color: #fff; -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;}

  *{box-sizing:border-box}
  a{color:inherit}
  .app{min-height:100vh;padding:18px;display:flex;align-items:flex-start;justify-content:center}
  .wrap{width:100%;max-width:980px;display:flex;flex-direction:column;gap:14px}

  /* Header */
  header{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{
    width:50px;height:50px;border-radius:12px;
    background:linear-gradient(135deg,#f8fbff33,#ffffff11);
    display:flex;align-items:center;justify-content:center;font-weight:900;font-size:20px;color:#fff;
    box-shadow: 0 8px 28px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.06);
    border:1px solid rgba(255,255,255,0.06);
    backdrop-filter: blur(8px) saturate(120%);
  }
  .title h1{margin:0;font-size:18px}
  .title p{margin:0;font-size:12px;color:rgba(255,255,255,0.7)}

  /* header action buttons (hidden install removed) */
  .hdr-actions{display:flex;gap:8px;align-items:center}
  .btn-pill{
    padding:8px 12px;border-radius:999px;border:1px solid var(--pill-border);
    background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
    font-weight:700;color:#fff;font-size:13px;
    backdrop-filter: blur(8px);
  }
  .btn-primary{
    background: linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.06));
    color:#071022;border:none;padding:8px 14px;border-radius:999px;font-weight:800;
    box-shadow: 0 8px 30px rgba(2,8,20,0.6), inset 0 1px 0 rgba(255,255,255,0.08);
  }

  /* Cards - silver frost */
  .card{
    border-radius: var(--radius);
    background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    border: 1px solid rgba(255,255,255,0.06);
    padding:14px;
    box-shadow: var(--shadow-1);
    backdrop-filter: blur(16px) saturate(120%);
  }

  /* hero */
  .hero{display:flex;gap:12px;align-items:center}
  .hero-left{flex:1}
  .big-num{font-size:26px;font-weight:900}
  .muted{color:rgba(255,255,255,0.72);font-size:13px}

  /* pill chips row */
  .chips{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
  .chip{
    border-radius:999px;padding:8px 12px;min-width:84px;text-align:center;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border: 1px solid rgba(255,255,255,0.03);
    font-weight:700;font-size:13px;
  }

  /* Timers section */
  .timers{display:flex;flex-direction:column;gap:12px;margin-top:12px}
  .timer-row{display:flex;align-items:center;gap:12px;justify-content:space-between}
  .timer-left{display:flex;align-items:center;gap:12px;flex:1}
  .badge{
    width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:800;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.04);
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
  }
  .timer-meta .title{font-weight:800;font-size:16px}
  .timer-meta .sub{font-size:12px;color:rgba(255,255,255,0.7);margin-top:6px}
  .progress{height:8px;border-radius:999px;background:rgba(255,255,255,0.02);overflow:hidden;margin-top:8px}
  .prog-fill{height:100%;width:0%;background:linear-gradient(90deg, rgba(255,255,255,0.12), rgba(255,255,255,0.06));box-shadow: 0 6px 18px rgba(0,0,0,0.6);}

  /* small action group */
  .timer-actions{display:flex;gap:8px;align-items:center}
  .small{padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.05);background:transparent;font-weight:700;color:#fff}

  /* charts section */
  .charts{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
  .charts .mini{padding:10px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);backdrop-filter: blur(12px)}

  canvas{width:100% !important;height:160px !important}

  /* logs */
  .logs{margin-top:12px;max-height:240px;overflow:auto;padding-right:6px}
  .session{padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);margin-bottom:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}

  /* note */
  textarea{width:100%;min-height:82px;border-radius:12px;padding:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#fff;resize:vertical}

  /* bottom nav (floating) */
  .bottom-nav{position:fixed;left:0;right:0;bottom:12px;display:flex;justify-content:center;pointer-events:auto}
  .nav-wrap{width:100%;max-width:980px;padding:0 18px;display:flex;justify-content:space-between;align-items:center}
  .nav-btn{padding:10px 14px;border-radius:999px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);font-weight:800;color:#fff}

  /* responsive: mobile-first single column */
  @media(min-width:820px){
    .charts canvas{height:200px !important}
    .hero{align-items:center}
  }
  @media(min-width:1100px){
    .wrap{max-width:1100px}
    .charts{grid-template-columns:1fr 1fr}
  }

  /* micro interactions */
  .btn-pill:active, .small:active, .nav-btn:active{transform:translateY(1px)}
  .chip{transition:transform .14s ease}
  .chip:active{transform:translateY(1px)}
</style>
</head>
<body>
  <div class="app">
    <div class="wrap" id="appRoot">

      <!-- HEADER -->
      <header>
        <div class="brand">
          <div class="logo">M</div>
          <div class="title">
            <h1>Momentum</h1>
            <p>Silver Frost • iOS-style • offline</p>
          </div>
        </div>

        <div class="hdr-actions">
          <button class="btn-pill" id="btnExport">Export</button>
          <button class="btn-pill" id="btnImport">Import</button>
        </div>
      </header>

      <!-- HERO -->
      <section class="card hero" aria-labelledby="heroTitle">
        <div class="hero-left">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="muted">Today's total</div>
              <div class="big-num" id="todayTotal">0m</div>
            </div>
            <div style="text-align:right">
              <div class="muted">Streak</div>
              <div style="font-weight:800" id="streak">0d</div>
            </div>
          </div>

          <div class="chips" id="chipRow">
            <!-- chips inserted here -->
          </div>
        </div>
      </section>

      <!-- TIMERS -->
      <section class="card" aria-labelledby="timersTitle">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <strong>Timers</strong>
            <div class="muted">Start sessions & hit your daily goals</div>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn-pill" id="btnAdd">+ Add</button>
            <button class="btn-pill" id="btnDefaults">Defaults</button>
          </div>
        </div>

        <div class="timers" id="timers"></div>

        <div style="display:flex;justify-content:flex-end;margin-top:12px">
          <button class="small" id="btnClearToday">Clear Today</button>
        </div>
      </section>

      <!-- CHARTS & LOGS -->
      <section class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div><strong>Analytics</strong><div class="muted">Local • last 7 days</div></div>
          <div class="muted" id="dateNow"></div>
        </div>

        <div class="charts">
          <div class="mini card">
            <canvas id="pieChart"></canvas>
          </div>
          <div class="mini card">
            <canvas id="barChart"></canvas>
          </div>
        </div>

        <div style="margin-top:12px" class="muted">Recent sessions</div>
        <div class="logs" id="logs"></div>
      </section>

      <!-- NOTE -->
      <section class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div><strong>Quick note</strong><div class="muted">Saved locally</div></div>
          <div class="muted">—</div>
        </div>
        <div style="margin-top:8px">
          <textarea id="note" placeholder="What did you achieve today?"></textarea>
          <div style="display:flex;justify-content:flex-end;margin-top:8px">
            <button class="btn-primary" id="saveNote">Save</button>
          </div>
        </div>
      </section>

      <footer style="text-align:center;color:rgba(255,255,255,0.6);font-size:12px;margin-bottom:86px">Offline-first • No cloud • Single file</footer>
    </div>
  </div>

  <!-- floating bottom nav -->
  <div class="bottom-nav" aria-hidden="false">
    <div class="nav-wrap">
      <button class="nav-btn" id="navHome">Home</button>
      <button class="nav-btn" id="navTimers">Timers</button>
      <button class="nav-btn" id="navCharts">Charts</button>
      <button class="nav-btn" id="navLogs">Logs</button>
    </div>
  </div>

<script>
/* Momentum - Silver Frost single-file app
   - Mobile-first iOS-like glass UI
   - LocalStorage state
   - Timers, manual logs, goals
   - Charts (Chart.js)
   - Export/Import JSON
   - PWA: manifest + inline service worker
   - No visible install button (but PWA supported)
*/

/* ---------- utils ---------- */
const uid = (n=8) => Math.random().toString(36).slice(2, 2+n);
const fmt = s => {
  if(s < 60) return s + 's';
  const h = Math.floor(s/3600), m = Math.floor((s%3600)/60);
  if(h) return h + 'h ' + m + 'm';
  return m + 'm';
}
const dayKey = d => d.toISOString().slice(0,10);

/* ---------- state ---------- */
const KEY = 'momentum.silver.v1';
let state = {
  categories: {}, // id: {id,name,goalSeconds,running,currentStart}
  sessions: [],   // {id,catId,start,stop,duration,date,notes}
  notes: {},      // date: text
  createdAt: Date.now()
};

function save(){ localStorage.setItem(KEY, JSON.stringify(state)); }
function load(){ try{ const raw = localStorage.getItem(KEY); if(raw) state = JSON.parse(raw); } catch(e){ console.warn('loaderr', e); } }
load();

/* ---------- defaults ---------- */
function addDefaults(){
  if(Object.keys(state.categories).length) return;
  addCategory('Study',6);
  addCategory('Project',4);
  addCategory('Workout',1);
  addCategory('Social',0.5);
}

/* ---------- categories ---------- */
function addCategory(name, hours=1){
  const id = uid(6);
  state.categories[id] = { id, name, goalSeconds: Math.round(hours*3600), running:false, currentStart:null };
  save(); renderAll();
  return id;
}
function removeCategory(id){
  delete state.categories[id];
  state.sessions = state.sessions.filter(s=>s.catId!==id);
  save(); renderAll();
}

/* ---------- timers ---------- */
function startTimer(id){
  // stop any other running (exclusive)
  Object.values(state.categories).forEach(c => { if(c.running) stopTimer(c.id) });
  const cat = state.categories[id];
  if(!cat) return;
  cat.running = true; cat.currentStart = Date.now();
  save(); renderAll(); startTicker();
}
function stopTimer(id, note=''){
  const cat = state.categories[id];
  if(!cat || !cat.running) return;
  const start = cat.currentStart || Date.now();
  const stop = Date.now();
  const dur = Math.round((stop - start)/1000);
  cat.running = false; cat.currentStart = null;
  const session = { id: uid(8), catId: id, start, stop, duration: dur, date: dayKey(new Date(start)), notes: note || '' };
  state.sessions.push(session);
  save(); renderAll();
}
function addManual(id, minutes){
  const dur = Math.round(minutes*60); const start = Date.now() - dur*1000;
  const session = { id: uid(8), catId: id, start, stop: Date.now(), duration: dur, date: dayKey(new Date(start)), notes: 'manual' };
  state.sessions.push(session); save(); renderAll();
}
function clearToday(){
  const t = dayKey(new Date());
  state.sessions = state.sessions.filter(s=>s.date !== t);
  if(state.notes) delete state.notes[t];
  save(); renderAll();
}

/* ---------- stats ---------- */
function totalForDate(d){
  return state.sessions.filter(s=>s.date===d).reduce((a,b)=>a+b.duration,0);
}
function totalForCatDate(catId,d){
  return state.sessions.filter(s=>s.catId===catId && s.date===d).reduce((a,b)=>a+b.duration,0);
}
function lastNDays(n=7,end=new Date()){
  const out=[]; for(let i=n-1;i>=0;i--){ const dt=new Date(end); dt.setDate(dt.getDate()-i); out.push(dayKey(dt)); } return out;
}

/* ---------- DOM refs ---------- */
const timersEl = document.getElementById('timers');
const chipRow = document.getElementById('chipRow');
const todayTotalEl = document.getElementById('todayTotal');
const streakEl = document.getElementById('streak');
const logsEl = document.getElementById('logs');
const dateNowEl = document.getElementById('dateNow');
const noteEl = document.getElementById('note');

/* ---------- render ---------- */
function renderAll(){
  renderHeader();
  renderChips();
  renderTimers();
  renderSummary();
  renderCharts();
  renderLogs();
  populateNote();
}
function renderHeader(){ dateNowEl.innerText = new Date().toLocaleDateString(); }
function renderChips(){
  chipRow.innerHTML = '';
  const ids = Object.keys(state.categories);
  ids.forEach(id=>{
    const c = state.categories[id];
    const sec = totalForCatDate(id, dayKey(new Date()));
    const div = document.createElement('div'); div.className='chip'; div.innerHTML = `<div style="font-weight:800">${c.name}</div><div style="font-size:12px;color:rgba(255,255,255,0.7)">${fmt(sec)}</div>`;
    chipRow.appendChild(div);
  });
}
function renderTimers(){
  timersEl.innerHTML = '';
  Object.keys(state.categories).forEach(id=>{
    const c = state.categories[id];
    const row = document.createElement('div'); row.className='timer-row';
    const left = document.createElement('div'); left.className='timer-left';
    left.innerHTML = `<div class="badge">${(c.name[0]||'•')}</div>
      <div class="timer-meta">
        <div class="title">${c.name}</div>
        <div class="sub">Goal: ${fmt(c.goalSeconds)}</div>
        <div class="progress"><div class="prog-fill" id="fill_${id}" style="width:0%"></div></div>
      </div>`;
    const actions = document.createElement('div'); actions.className='timer-actions';
    const start = document.createElement('button'); start.className='small'; start.textContent='Start';
    const stop = document.createElement('button'); stop.className='small'; stop.textContent='Stop';
    const log = document.createElement('button'); log.className='small'; log.textContent='Log';
    const del = document.createElement('button'); del.className='small'; del.textContent='Del';
    if(c.running) start.disabled = true;
    if(!c.running) stop.disabled = true;
    actions.appendChild(start); actions.appendChild(stop); actions.appendChild(log); actions.appendChild(del);
    row.appendChild(left); row.appendChild(actions);
    timersEl.appendChild(row);

    // progress
    const sec = totalForCatDate(id, dayKey(new Date())) + (c.running && c.currentStart ? Math.round((Date.now()-c.currentStart)/1000) : 0);
    const pct = Math.min(100, Math.round((sec/(c.goalSeconds||1))*100));
    const fill = document.getElementById(`fill_${id}`);
    if(fill) fill.style.width = pct + '%';

    // events
    start.onclick = ()=>startTimer(id);
    stop.onclick = ()=>{ const note = prompt('Optional note for this session','') || ''; stopTimer(id, note); };
    log.onclick = ()=>{ const m = parseFloat(prompt('Minutes to add','30')); if(!isNaN(m) && m>0) addManual(id,m); };
    del.onclick = ()=>{ if(confirm('Delete category and its sessions?')) removeCategory(id); };
  });
}
function renderSummary(){
  const t = dayKey(new Date());
  const tot = totalForDate(t);
  todayTotalEl.innerText = fmt(tot);
  // streak
  const days = lastNDays(30);
  let s=0;
  for(let i=days.length-1;i>=0;i--){
    if(totalForDate(days[i]) > 10*60) s++; else break;
  }
  streakEl.innerText = s + 'd';
}
function renderLogs(){
  logsEl.innerHTML = '';
  const recent = state.sessions.slice().reverse().slice(0,80);
  recent.forEach(s=>{
    const name = state.categories[s.catId] ? state.categories[s.catId].name : 'Unknown';
    const when = new Date(s.start).toLocaleString();
    const div = document.createElement('div'); div.className='session';
    div.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center">
        <div><strong>${name}</strong> <small style="color:rgba(255,255,255,0.72)">• ${fmt(s.duration)}</small></div>
        <div style="font-size:12px;color:rgba(255,255,255,0.66)">${when}</div>
      </div>
      ${s.notes ? `<div style="margin-top:8px"><small style="color:rgba(255,255,255,0.66)">${s.notes}</small></div>`:''}`;
    logsEl.appendChild(div);
  });
}
function populateNote(){ noteEl.value = state.notes[dayKey(new Date())] || ''; }

/* ---------- charts ---------- */
let pieChart=null, barChart=null;
function renderCharts(){
  const cats = Object.keys(state.categories);
  const labels = cats.map(id=>state.categories[id].name);
  const today = dayKey(new Date());
  const pieData = cats.map(id => Math.round(totalForCatDate(id,today)/60));
  const ctxPie = document.getElementById('pieChart').getContext('2d');
  if(pieChart) pieChart.destroy();
  pieChart = new Chart(ctxPie, {
    type: 'doughnut',
    data: { labels, datasets: [{ data: pieData, backgroundColor: labels.map((_,i)=> ['#e6edf7','#f7fbff','#eef6f2','#f7f0f7'][i%4]) }] },
    options:{plugins:{legend:{position:'bottom'}}, maintainAspectRatio:false}
  });

  const days = lastNDays(7);
  const bars = days.map(d=>Math.round(totalForDate(d)/60));
  const ctxBar = document.getElementById('barChart').getContext('2d');
  if(barChart) barChart.destroy();
  barChart = new Chart(ctxBar, {
    type: 'bar',
    data: { labels: days.map(d=>d.slice(5)), datasets: [{ label:'Minutes', data:bars, backgroundColor:'#dfe8ff' }] },
    options:{plugins:{legend:{display:false}}, scales:{y:{beginAtZero:true}}, maintainAspectRatio:false}
  });
}

/* ---------- ticker ---------- */
let ticker = null;
function startTicker(){
  if(ticker) return;
  ticker = setInterval(()=>{ renderTimers(); renderSummary(); if(Math.random()<0.06) renderCharts(); }, 1000);
}
function stopTicker(){ if(ticker){ clearInterval(ticker); ticker=null; } }

/* ---------- export / import ---------- */
function exportJSON(){
  const blob = new Blob([JSON.stringify(state, null, 2)], {type:'application/json'});
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'momentum-silver.json'; a.click();
}
function importJSON(file){
  const r = new FileReader();
  r.onload = e => {
    try{
      const data = JSON.parse(e.target.result);
      if(confirm('Replace local data with imported file?')){ state = data; save(); renderAll(); alert('Imported'); }
    } catch(err){ alert('Invalid JSON'); }
  };
  r.readAsText(file);
}

/* ---------- note save ---------- */
document.getElementById('saveNote').onclick = ()=>{
  state.notes = state.notes || {};
  state.notes[dayKey(new Date())] = noteEl.value.trim();
  save(); alert('Saved locally');
};

/* ---------- UI buttons ---------- */
document.getElementById('btnAdd').onclick = ()=>{
  const name = prompt('Category name (e.g., Reading)','New Category'); if(!name) return;
  const hrs = parseFloat(prompt('Daily goal hours (e.g., 1.5)','1')) || 1;
  addCategory(name, hrs);
};
document.getElementById('btnDefaults').onclick = ()=>{ addDefaults(); save(); renderAll(); };
document.getElementById('btnClearToday').onclick = ()=>{ if(confirm('Clear today sessions and note?')) clearToday(); };
document.getElementById('btnExport').onclick = exportJSON;
document.getElementById('btnImport').onclick = ()=>{
  const inp = document.createElement('input'); inp.type='file'; inp.accept='.json,application/json'; inp.onchange = ()=>importJSON(inp.files[0]); inp.click();
};

/* nav */
document.getElementById('navHome').onclick = ()=>window.scrollTo({top:0,behavior:'smooth'});
document.getElementById('navTimers').onclick = ()=>document.querySelector('.card:nth-of-type(2)').scrollIntoView({behavior:'smooth'});
document.getElementById('navCharts').onclick = ()=>document.querySelector('.card:nth-of-type(3)').scrollIntoView({behavior:'smooth'});
document.getElementById('navLogs').onclick = ()=>document.querySelector('.card:nth-of-type(3)').scrollIntoView({behavior:'smooth'});

/* ---------- PWA manifest (dynamic) ---------- */
(function createManifest(){
  const manifest = {
    name: "Momentum",
    short_name: "Momentum",
    start_url: ".",
    display: "standalone",
    background_color: "#071022",
    theme_color: "#071022",
    icons: [{ src: "data:image/svg+xml;base64," + btoa(`<svg xmlns='http://www.w3.org/2000/svg' width='512' height='512'><rect rx='48' width='100%' height='100%' fill='#ffffff22'/><text x='50%' y='55%' font-size='260' text-anchor='middle' fill='white' font-family='Arial' font-weight='700'>M</text></svg>`), sizes:"512x512", type:"image/svg+xml" }]
  };
  const blob = new Blob([JSON.stringify(manifest)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  let link = document.querySelector('link[rel="manifest"]');
  if(!link){ link = document.createElement('link'); link.rel='manifest'; document.head.appendChild(link); }
  link.href = url;
})();

/* ---------- Service worker (inline blob) ---------- */
(function registerSW(){
  if('serviceWorker' in navigator){
    const code = `
      const CACHE = 'momentum-silver-v1';
      const urls = ['./'];
      self.addEventListener('install', e=>{ self.skipWaiting(); e.waitUntil(caches.open(CACHE).then(c=>c.addAll(urls)).catch(()=>{})); });
      self.addEventListener('activate', e=>e.waitUntil(self.clients.claim()));
      self.addEventListener('fetch', e=>{ if(e.request.method !== 'GET') return; e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request)).catch(()=>caches.match('./'))); });
    `;
    const blob = new Blob([code], {type:'application/javascript'});
    const swUrl = URL.createObjectURL(blob);
    navigator.serviceWorker.register(swUrl).then(()=>console.log('sw ok')).catch(()=>console.warn('sw fail'));
  }
})();

/* ---------- start ---------- */
addDefaults(); renderAll(); startTicker();
window.addEventListener('visibilitychange', ()=>{ if(document.hidden) save(); });
window.addEventListener('beforeunload', save);

/* expose state for debug */
window._momentum = ()=>state;
</script>
</body>
</html>
